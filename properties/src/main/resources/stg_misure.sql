SELECT  
NVL(TO_NUMBER(ROUND(A_1_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as A_1_NUM	 ,
NVL(TO_NUMBER(ROUND(A_1_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as A_1_UFP  ,
NVL(TO_NUMBER(ROUND(A_2_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as A_2_NUM  ,
NVL(TO_NUMBER(ROUND(A_2_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as A_2_UFP  ,
NVL(TO_NUMBER(ROUND(ADJMAX,1), '999999999D99','nls_numeric_characters=,.'),0) as ADJMAX   ,
NVL(TO_NUMBER(ROUND(ADJMIN,1), '999999999D99','nls_numeric_characters=,.'),0) as ADJMIN   ,
NVL(TO_NUMBER(ROUND(ADJUFP,1), '999999999D99','nls_numeric_characters=,.'),0) as ADJUFP   ,
AMBITO  ,
APPROCCIO                                               ,
NVL(TO_NUMBER(ROUND(B_1_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as B_1_NUM  ,
NVL(TO_NUMBER(ROUND(B_1_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as B_1_UFP  ,
NVL(TO_NUMBER(ROUND(B_2_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as B_2_NUM  ,
NVL(TO_NUMBER(ROUND(B_2_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as B_2_UFP  ,
NVL(TO_NUMBER(ROUND(B_3_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as B_3_NUM  ,
NVL(TO_NUMBER(ROUND(B_3_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as B_3_UFP  ,
NVL(TO_NUMBER(ROUND(B_5_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as B_5_NUM  ,
NVL(TO_NUMBER(ROUND(B_5_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as B_5_UFP  ,
NVL(TO_NUMBER(ROUND(BFP_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as BFP_NUM  ,
NVL(TO_NUMBER(ROUND(BFP_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as BFP_UFP  ,
NVL(TO_NUMBER(ROUND(C_1_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as C_1_NUM  ,
NVL(TO_NUMBER(ROUND(C_1_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as C_1_UFP  ,
NVL(TO_NUMBER(ROUND(C_2_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as C_2_NUM  ,
NVL(TO_NUMBER(ROUND(C_2_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as C_2_UFP  ,
CONFINE ,
NVL(TO_NUMBER(ROUND(CRUD_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as CRUD_NUM ,
NVL(TO_NUMBER(ROUND(CRUD_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as CRUD_UFP ,
NVL(TO_NUMBER(ROUND(D_1_NUM,1) , '999999999D99','nls_numeric_characters=,.'),0) as D_1_NUM  ,
NVL(TO_NUMBER(ROUND(D_1_UFP,1) , '999999999D99','nls_numeric_characters=,.'),0) as D_1_UFP  ,
NVL(TO_NUMBER(ROUND(D_2_NUM,1) , '999999999D99','nls_numeric_characters=,.'),0) as D_2_NUM  ,
NVL(TO_NUMBER(ROUND(D_2_UFP,1) , '999999999D99','nls_numeric_characters=,.'),0) as D_2_UFP  ,
TO_TIMESTAMP(DT_CONSOLIDAMENTO ,'DD-MM-YYYY HH24:MI:SS.FF') as DT_CONSOLIDAMENTO,
TO_TIMESTAMP(DT_CREAZIONE ,'DD-MM-YYYY HH24:MI:SS.FF') as DT_CREAZIONE,
TO_TIMESTAMP(DT_RIFERIMENTO ,'DD-MM-YYYY HH24:MI:SS.FF') as DT_RIFERIMENTO,
DMALM_STG_MISURA_PK,
NVL(TO_NUMBER(ROUND(EI_NUM,1) , '999999999D99','nls_numeric_characters=,.'),0) as EI_NUM   ,
NVL(TO_NUMBER(ROUND(EI_UFP,1) , '999999999D99','nls_numeric_characters=,.'),0) as EI_UFP   ,
NVL(TO_NUMBER(ROUND(EIF_NUM,1), '999999999D99','nls_numeric_characters=,.'),0) as EIF_NUM  ,
NVL(TO_NUMBER(ROUND(EIF_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as EIF_UFP  ,
NVL(TO_NUMBER(ROUND(EO_NUM,1) , '999999999D99','nls_numeric_characters=,.'),0) as EO_NUM   ,
NVL(TO_NUMBER(ROUND(EO_UFP,1) , '999999999D99','nls_numeric_characters=,.'),0) as EO_UFP   ,
NVL(TO_NUMBER(ROUND(EQ_NUM,1) , '999999999D99','nls_numeric_characters=,.'),0) as EQ_NUM   ,
NVL(TO_NUMBER(ROUND(EQ_UFP,1) , '999999999D99','nls_numeric_characters=,.'),0) as EQ_UFP   ,
ESPERIENZA ,
FASE_CICLO_DI_VITA ,
FONTI   ,
NVL(TO_NUMBER(ROUND(FP_NON_PESATI_MAX,1), '999999999D99','nls_numeric_characters=,.'),0) as FP_NON_PESATI_MAX ,
NVL(TO_NUMBER(ROUND(FP_NON_PESATI_MIN,1), '999999999D99','nls_numeric_characters=,.'),0) as FP_NON_PESATI_MIN  ,
NVL(TO_NUMBER(ROUND(FP_NON_PESATI_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as FP_NON_PESATI_UFP  ,
NVL(TO_NUMBER(ROUND(FP_PESATI_MAX,1), '999999999D99','nls_numeric_characters=,.'),0) as FP_PESATI_MAX  ,
NVL(TO_NUMBER(ROUND(FP_PESATI_MIN,1), '999999999D99','nls_numeric_characters=,.'),0) as FP_PESATI_MIN  ,
NVL(TO_NUMBER(ROUND(FP_PESATI_UFP,1), '999999999D99','nls_numeric_characters=,.'),0) as FP_PESATI_UFP  ,
NVL(TO_NUMBER(ROUND(FU_NUM,1)   , '999999999D99','nls_numeric_characters=,.'),0) as FU_NUM   ,
NVL(TO_NUMBER(ROUND(FU_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as FU_UFP   ,
NVL(TO_NUMBER(ROUND(GDG_NUM,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GDG_NUM  ,
NVL(TO_NUMBER(ROUND(GDG_UFP,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GDG_UFP  ,
NVL(TO_NUMBER(ROUND(GEI_NUM,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GEI_NUM  ,
NVL(TO_NUMBER(ROUND(GEI_UFP,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GEI_UFP  ,
NVL(TO_NUMBER(ROUND(GEIF_NUM,1) , '999999999D99','nls_numeric_characters=,.'),0) as GEIF_NUM ,
NVL(TO_NUMBER(ROUND(GEIF_UFP,1) , '999999999D99','nls_numeric_characters=,.'),0) as GEIF_UFP ,
NVL(TO_NUMBER(ROUND(GEO_NUM,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GEO_NUM  ,
NVL(TO_NUMBER(ROUND(GEO_UFP,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GEO_UFP  ,
NVL(TO_NUMBER(ROUND(GEQ_NUM,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GEQ_NUM  ,
NVL(TO_NUMBER(ROUND(GEQ_UFP,1)  , '999999999D99','nls_numeric_characters=,.'),0) as GEQ_UFP  ,
NVL(TO_NUMBER(ROUND(GILF_NUM,1) , '999999999D99','nls_numeric_characters=,.'),0) as GILF_NUM ,
NVL(TO_NUMBER(ROUND(GILF_UFP,1) , '999999999D99','nls_numeric_characters=,.'),0) as GILF_UFP ,
NVL(TO_NUMBER(ROUND(GP_NUM,1)   , '999999999D99','nls_numeric_characters=,.'),0) as GP_NUM   ,
NVL(TO_NUMBER(ROUND(GP_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as GP_UFP   ,
ID_MSR   ,
NVL(TO_NUMBER(ROUND(IFP_NUM,1)   , '999999999D99','nls_numeric_characters=,.'),0) as IFP_NUM  ,
NVL(TO_NUMBER(ROUND(IFP_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as IFP_UFP  ,
NVL(TO_NUMBER(ROUND(ILF_NUM,1)   , '999999999D99','nls_numeric_characters=,.'),0) as ILF_NUM  ,
NVL(TO_NUMBER(ROUND(ILF_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as ILF_UFP  ,
NVL(TO_NUMBER(ROUND(LDG_NUM,1)   , '999999999D99','nls_numeric_characters=,.'),0) as LDG_NUM  ,
NVL(TO_NUMBER(ROUND(LDG_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as LDG_UFP  ,
LINK_DOCUMENTALE ,
NOTE_MSR,
METODO  ,
NVL(TO_NUMBER(ROUND(LDG_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as MF_NUM   ,
NVL(TO_NUMBER(ROUND(LDG_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as MF_UFP   ,
NOME_MISURA      ,
NVL(TO_NUMBER(ROUND(LDG_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as MLDG_NUM ,
NVL(TO_NUMBER(ROUND(LDG_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as MLDG_UFP ,
MODELLO ,
NVL(TO_NUMBER(ROUND(MP_NUM,1)    , '999999999D99','nls_numeric_characters=,.'),0) as MP_NUM   ,
NVL(TO_NUMBER(ROUND(MP_UFP,1)    , '999999999D99','nls_numeric_characters=,.'),0) as MP_UFP   ,
NVL(TO_NUMBER(ROUND(PF_NUM,1)    , '999999999D99','nls_numeric_characters=,.'),0) as PF_NUM   ,
NVL(TO_NUMBER(ROUND(PF_UFP,1)    , '999999999D99','nls_numeric_characters=,.'),0) as PF_UFP   ,
POST_VER_ADD_CFP ,
POST_VER_CHG     ,
POST_VER_DEL     ,
POST_VER_FP      ,
PRE_VER_ADD_CFP  ,
PRE_VER_CHG      ,
PRE_VER_DEL ,
PRE_VER_FP ,
RESPONSABILE     ,
SCOPO   ,
STATO_MISURA     ,
NOME_PROGETTO as PROGETTO_SFERA, 
NVL(TO_NUMBER(ROUND(TP_NUM ,1)    , '999999999D99','nls_numeric_characters=,.'),0) as TP_NUM   ,
NVL(TO_NUMBER(ROUND(TP_UFP,1)     , '999999999D99','nls_numeric_characters=,.'),0) as TP_UFP   ,
NVL(TO_NUMBER(ROUND(UGDG_NUM,1)   , '999999999D99','nls_numeric_characters=,.'),0) as UGDG_NUM ,
NVL(TO_NUMBER(ROUND(UGDG_UFP,1)   , '999999999D99','nls_numeric_characters=,.'),0) as UGDG_UFP ,
NVL(TO_NUMBER(ROUND(UGEP_NUM,1)   , '999999999D99','nls_numeric_characters=,.'),0) as UGEP_NUM ,
NVL(UGEP_UFP  ,0) as UGEP_UFP ,
NVL(TO_NUMBER(ROUND(UGO_NUM,1)    , '999999999D99','nls_numeric_characters=,.'),0) as UGO_NUM  ,
NVL(TO_NUMBER(ROUND(UGO_UFP,1)    , '999999999D99','nls_numeric_characters=,.'),0) as UGO_UFP  ,
NVL(TO_NUMBER(ROUND(UGP_NUM,1)    , '999999999D99','nls_numeric_characters=,.'),0) as UGP_NUM  ,
NVL(TO_NUMBER(ROUND(UGP_UFP,1)    , '999999999D99','nls_numeric_characters=,.'),0) as UGP_UFP  ,
UTENTE_MISURATORE ,
ID_PROGETTO,
ID_ASM,
VER_DELTA as Valore_scostamento,
VER_DELTA_PERCENT as Percentuale_di_scostamento ,
TO_TIMESTAMP(VER_END, 'DD-MM-YYYY HH24:MI:SS.FF') as DT_FINE_VERIFICA_FP  ,
TO_TIMESTAMP(VER_START, 'DD-MM-YYYY HH24:MI:SS.FF') as DT_INIZIO_VERIFICA_FP  , 
VERSIONE_MSR, 
APPLICAZIONE, 
DM_ALM_MISURA_SEQ.nextval as DMALM_MISURA_PK 
FROM DMALM_STG_MISURA 
where DT_CARICAMENTO = ?     
and ID_MSR != 0  
AND ID_PROGETTO != 0 
AND NOT UPPER(NVL(nome_progetto, ' ')) LIKE 'UFFICIOSO%' 
AND NOT UPPER(NVL(nome_misura, ' ')) LIKE 'UFFICIOSO%' 