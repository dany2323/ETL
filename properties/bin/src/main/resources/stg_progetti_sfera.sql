SELECT 
MIN(DMALM_STG_MISURA_PK) AS DMALM_STG_MISURA_PK,
COSTO,
TO_TIMESTAMP(DT_FINE_EFFETTIVA, 'DD-MM-YYYY HH24:MI:SS.FF') as DT_FINE_EFFETTIVA,
TO_TIMESTAMP(DT_AVVIO,'DD-MM-YYYY HH24:MI:SS.FF') as DT_AVVIO,
DT_CARICAMENTO,
DURATA_EFFETTIVA,
ID_PROGETTO,
IMPEGNO_EFFETTIVO,
INCLUDE_IN_BENCHMARKING_DB,
NOTE_PRJ,
P_PRJ_A_DISPOSIZIONE_01,
P_PRJ_A_DISPOSIZIONE_02,
P_PRJ_AMB_TECN_PORTALI,
P_PRJ_AUDIT_INDEX_VERIFY,
P_PRJ_AUDIT_MONITORE,
P_PRJ_CD_RDI,
TO_TIMESTAMP(P_PRJ_DT_CONSEGNA_MPP_FORN,'DD-MM-YYYY HH24:MI:SS.FF') as P_PRJ_DT_CONSEGNA_MPP_FORN,
P_PRJ_FCC_FATT_CORREZ_TOTAL,
P_PRJ_FL_AMB_TEC_TRANS_BAT_REP,
P_PRJ_FL_AMB_TECN_PIAT_ENTERPR,
P_PRJ_FL_AMBITO_TECN_FUTURO01,
P_PRJ_FL_AMBITO_TECN_FUTURO02,
P_PRJ_FL_APPL_LG_FP_EDMA,
P_PRJ_FL_APPL_LG_FP_WEB,
P_PRJ_FL_APPLIC_LG_FP_DWH,
P_PRJ_FL_APPLIC_LG_FP_FUTURO01,
P_PRJ_FL_APPLIC_LG_FP_FUTURO02, 
P_PRJ_FL_AMB_TECN_GIS,
P_PRJ_FL_APPL_LG_FP_GIS,
P_PRJ_FL_APPL_LG_FP_MWARE,
(CASE P_PRJ_FORNITORE_MPP     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0 
ELSE 0 
END) as P_PRJ_FORNITORE_MPP,
(CASE P_PRJ_FORNITORE_SVILUPPO_MEV     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0  
ELSE 0 
END) as P_PRJ_FORNITORE_SVILUPPO_MEV,
(CASE P_PRJ_IMPORTO_A_CONSUNTIVO     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0   
ELSE 0  
END) as P_PRJ_IMPORTO_A_CONSUNTIVO,
(CASE P_PRJ_IMPORTO_RDI_A_PREVENTIVO     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0  
ELSE 0   
END) as P_PRJ_IMPORTO_RDI_A_PREVENTIVO,
(CASE P_PRJ_INDEX_ALM_VALID_PROG_ASM     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0  
ELSE 0  
END) as P_PRJ_INDEX_ALM_VALID_PROG_ASM,
(CASE P_PRJ_MFC_A_CONSUNTIVO    
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0  
ELSE 0  
END) as P_PRJ_MFC_A_CONSUNTIVO,
(CASE P_PRJ_MFC_A_PREVENTIVO     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0  
ELSE 0  
END) as P_PRJ_MFC_A_PREVENTIVO,
(CASE P_PRJ_MP_PERCENT_CICLO_DI_VITA     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0 
ELSE 0  
END) as P_PRJ_MP_PERCENT_CICLO_DI_VITA,
(CASE P_PRJ_PUN_PREZZO_UNIT_NOMINAL     
WHEN 'SI' THEN 1 
WHEN 'NO' THEN 0 
ELSE 0  
END) as P_PRJ_PUN_PREZZO_UNIT_NOMINAL,
PRJ_CLS,
NOME_PROGETTO,
STAFF_MEDIO,
TIPO_PROGETTO,
VERSIONE_PRJ,
CICLO_DI_VITA,
APPLICAZIONE, 
ID_ASM 
FROM DMALM_STG_MISURA 
WHERE DT_CARICAMENTO = ? 
AND ID_PROGETTO != 0 
AND NOT UPPER(NVL(nome_progetto, ' ')) LIKE 'UFFICIOSO%' 
GROUP BY 
COSTO,
DT_FINE_EFFETTIVA,
DT_AVVIO,
DT_CARICAMENTO,
DURATA_EFFETTIVA,
ID_PROGETTO,
IMPEGNO_EFFETTIVO,
INCLUDE_IN_BENCHMARKING_DB,
NOTE_PRJ,
P_PRJ_A_DISPOSIZIONE_01,
P_PRJ_A_DISPOSIZIONE_02,
P_PRJ_AMB_TECN_PORTALI,
P_PRJ_AUDIT_INDEX_VERIFY,
P_PRJ_AUDIT_MONITORE,
P_PRJ_CD_RDI,
P_PRJ_DT_CONSEGNA_MPP_FORN,
P_PRJ_FCC_FATT_CORREZ_TOTAL,
P_PRJ_FL_AMB_TEC_TRANS_BAT_REP,
P_PRJ_FL_AMB_TECN_PIAT_ENTERPR,
P_PRJ_FL_AMBITO_TECN_FUTURO01,
P_PRJ_FL_AMBITO_TECN_FUTURO02,
P_PRJ_FL_APPL_LG_FP_EDMA,
P_PRJ_FL_APPL_LG_FP_WEB,
P_PRJ_FL_APPLIC_LG_FP_DWH,
P_PRJ_FL_APPLIC_LG_FP_FUTURO01,
P_PRJ_FL_APPLIC_LG_FP_FUTURO02, 
P_PRJ_FL_AMB_TECN_GIS,
P_PRJ_FL_APPL_LG_FP_GIS,
P_PRJ_FL_APPL_LG_FP_MWARE,
P_PRJ_FORNITORE_MPP,
P_PRJ_FORNITORE_SVILUPPO_MEV,
P_PRJ_IMPORTO_A_CONSUNTIVO,
P_PRJ_IMPORTO_RDI_A_PREVENTIVO,
P_PRJ_INDEX_ALM_VALID_PROG_ASM,
P_PRJ_MFC_A_CONSUNTIVO,
P_PRJ_MFC_A_PREVENTIVO,
P_PRJ_MP_PERCENT_CICLO_DI_VITA,
P_PRJ_PUN_PREZZO_UNIT_NOMINAL,
PRJ_CLS,
NOME_PROGETTO,
STAFF_MEDIO,
TIPO_PROGETTO,
VERSIONE_PRJ,
CICLO_DI_VITA,
APPLICAZIONE, 
ID_ASM  
ORDER BY ID_ASM, ID_PROGETTO 
